<div class="cart-modal-backdrop" (click)="closeCart()" *ngIf="isOpen"></div>

<div class="cart-modal" *ngIf="isOpen">
  <div class="cart-header">
    <h2>ðŸ›’ Dein Warenkorb</h2>
    <button class="close-btn" (click)="closeCart()">Ã—</button>
  </div>

<ng-container *ngIf="(cartItems$ | async) as cartItems">
  <div class="cart-body" *ngIf="cartItems.length; else emptyCart">
    <div class="cart-item" *ngFor="let item of cartItems; let i = index" [ngClass]="{ 'alt-bg': i % 2 === 1 }">

      <div class="item-info">
        <h3>{{ item.title }}</h3>

        <div class="item-detail">
          <strong>HinzugefÃ¼gt:</strong>
          {{ item.zutatenHinzugefuegt.length ? item.zutatenHinzugefuegt.join(', ') : 'â€“' }}
        </div>

        <div class="item-detail">
          <strong>Entfernt:</strong>
          {{ item.zutatenEntfernt.length ? item.zutatenEntfernt.join(', ') : 'â€“' }}
        </div>

        <div class="item-detail" *ngIf="item.groesse">
          <strong>GrÃ¶ÃŸe:</strong> {{ item.groesse }}
        </div>

        <div class="item-detail" *ngIf="item.extrawunsch">
          <strong>Extrawunsch:</strong> {{ item.extrawunsch }}
        </div>

        <div class="item-detail price">
          <strong>Preis:</strong>
          {{ item.preis | currency:'EUR':'symbol':'1.2-2' }}
          <span *ngIf="item.quantity > 1">
            Ã— {{ item.quantity }} = 
            <strong>{{ (item.preis * item.quantity) | currency:'EUR':'symbol':'1.2-2' }}</strong>
          </span>
        </div>
      </div>

      <div class="item-controls">
        <button class="remove" (click)="removeItem(item)">âœ•</button>
        <div class="descrease-increase">
          <button (click)="decreaseQuantity(item)" [disabled]="item.quantity <= 1">âˆ’</button>
        <span>{{ item.quantity }}</span>
        <button (click)="increaseQuantity(item)">+</button>
        </div>
      </div>

    </div>
  </div>
</ng-container>

  <!-- Footer -->
  <div class="cart-footer" *ngIf="(cartItems$ | async)?.length">
    <div class="total">
      Gesamt: <strong>{{ getTotal() | currency:'EUR' }}</strong>
    </div>
    <app-button (click)="checkout()" text="Zur Kasse" shadowColor="rgba(0, 0, 0, 0.5)" textColor="white" backgroundColor="rgb(160,0,0)"></app-button>
  </div>

  <ng-template #emptyCart>
    <div class="empty-cart">
      <p>Dein Warenkorb ist leer.</p>
      
<app-button (click)="closeCart()" text="Zur Speisekarte" shadowColor="rgba(0, 0, 0, 0.5)" textColor="white" backgroundColor="rgb(160,0,0)" routerLink="/speisen"></app-button>
    </div>
  </ng-template>
</div>