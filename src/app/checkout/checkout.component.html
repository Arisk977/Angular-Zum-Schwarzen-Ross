<app-header></app-header>
<div class="checkout-container">
  <!-- üßæ √úberschrift -->
  <h2 class="checkout-title">Bestellung aufgeben</h2>

  <!-- üõí Warenkorb√ºbersicht -->
  <div class="cart-overview" *ngIf="(cartItems$ | async) as cartItems">
    <div class="cart-item" *ngFor="let item of cartItems">
      <div class="item-info">
        <h4>{{ item.title }}</h4>
        <p *ngIf="item.groesse"><strong>Gr√∂√üe:</strong> {{ item.groesse }}</p>
        <p *ngIf="item.zutatenHinzugefuegt?.length">
          <strong>Hinzugef√ºgt:</strong> {{ item.zutatenHinzugefuegt.join(', ') }}
        </p>
        <p *ngIf="item.zutatenEntfernt?.length">
          <strong>Entfernt:</strong> {{ item.zutatenEntfernt.join(', ') }}
        </p>
        <p><strong>Preis:</strong> {{ item.preis | currency: 'EUR' }}</p>
      </div>
    </div>

    <!-- üí∞ Gesamtsumme -->
    <div class="total-sum">
      <strong>Gesamtsumme:</strong> {{ totalPrice | currency: 'EUR' }}
    </div>
  </div>

  <hr />

  <!-- üöö Lieferoptionen -->
  <div class="delivery-options">
    <h3>Lieferoption</h3>
    <label>
      <input type="radio" name="deliveryType" value="abholung" [(ngModel)]="deliveryType" />
      Zur Abholung
    </label>

    <label>
      <input type="radio" name="deliveryType" value="lieferung" [(ngModel)]="deliveryType" />
      Nach Hause liefern
    </label>
  </div>

  <!-- üßç Formularfelder f√ºr Abholung -->
  <div class="pickup-form" *ngIf="deliveryType === 'abholung'">
    <h4>Abholinformationen</h4>

    <!-- Vorname -->
    <div class="form-group">
      <label for="firstName">Vorname *</label>
      <input
        type="text"
        id="firstName"
        [(ngModel)]="checkoutForm.firstName"
        name="firstName"
        required
        #firstNameRef="ngModel"
        [class.invalid]="firstNameRef.invalid && firstNameRef.touched"
      />
      <div class="error-message" *ngIf="firstNameRef.invalid && firstNameRef.touched">
        Bitte Vornamen eingeben.
      </div>
    </div>

    <!-- Nachname -->
    <div class="form-group">
      <label for="lastName">Nachname *</label>
      <input
        type="text"
        id="lastName"
        [(ngModel)]="checkoutForm.lastName"
        name="lastName"
        required
        #lastNameRef="ngModel"
        [class.invalid]="lastNameRef.invalid && lastNameRef.touched"
      />
      <div class="error-message" *ngIf="lastNameRef.invalid && lastNameRef.touched">
        Bitte Nachnamen eingeben.
      </div>
    </div>

    <!-- Telefonnummer -->
    <div class="form-group">
      <label for="phone">Telefonnummer *</label>
      <input
        type="tel"
        id="phone"
        [(ngModel)]="checkoutForm.phone"
        name="phone"
        required
        #phoneRef="ngModel"
        [class.invalid]="phoneRef.invalid && phoneRef.touched"
      />
      <div class="error-message" *ngIf="phoneRef.invalid && phoneRef.touched">
        Bitte Telefonnummer eingeben.
      </div>
    </div>

    <!-- Uhrzeit optional -->
    <div class="form-group">
      <label for="pickupTime">Bestimmte Uhrzeit (optional)</label>
      <input type="time" id="pickupTime" [(ngModel)]="checkoutForm.pickupTime" />
    </div>
  </div>

  <!-- üè° Formularfelder f√ºr Lieferung -->
  <div class="delivery-form" *ngIf="deliveryType === 'lieferung'">
    <h4>Lieferinformationen</h4>

    <!-- Vorname -->
    <div class="form-group">
      <label for="firstName-delivery">Vorname *</label>
      <input
        type="text"
        id="firstName-delivery"
        [(ngModel)]="checkoutForm.firstName"
        name="firstNameDelivery"
        required
        #firstNameDeliveryRef="ngModel"
        [class.invalid]="firstNameDeliveryRef.invalid && firstNameDeliveryRef.touched"
      />
      <div class="error-message" *ngIf="firstNameDeliveryRef.invalid && firstNameDeliveryRef.touched">
        Bitte Vornamen eingeben.
      </div>
    </div>

    <!-- Nachname -->
    <div class="form-group">
      <label for="lastName-delivery">Nachname *</label>
      <input
        type="text"
        id="lastName-delivery"
        [(ngModel)]="checkoutForm.lastName"
        name="lastNameDelivery"
        required
        #lastNameDeliveryRef="ngModel"
        [class.invalid]="lastNameDeliveryRef.invalid && lastNameDeliveryRef.touched"
      />
      <div class="error-message" *ngIf="lastNameDeliveryRef.invalid && lastNameDeliveryRef.touched">
        Bitte Nachnamen eingeben.
      </div>
    </div>

    <!-- Ort -->
    <div class="form-group">
      <label for="city">Ort *</label>
      <input
        type="text"
        id="city"
        [(ngModel)]="checkoutForm.city"
        name="city"
        required
        #cityRef="ngModel"
        [class.invalid]="cityRef.invalid && cityRef.touched"
      />
      <div class="error-message" *ngIf="cityRef.invalid && cityRef.touched">
        Bitte Ort eingeben.
      </div>
    </div>

    <!-- PLZ -->
    <div class="form-group">
      <label for="zip">PLZ *</label>
      <input
        type="text"
        id="zip"
        [(ngModel)]="checkoutForm.zip"
        name="zip"
        required
        #zipRef="ngModel"
        [class.invalid]="zipRef.invalid && zipRef.touched"
      />
      <div class="error-message" *ngIf="zipRef.invalid && zipRef.touched">
        Bitte PLZ eingeben.
      </div>
    </div>

    <!-- Stra√üe -->
    <div class="form-group">
      <label for="street">Stra√üe *</label>
      <input
        type="text"
        id="street"
        [(ngModel)]="checkoutForm.street"
        name="street"
        required
        #streetRef="ngModel"
        [class.invalid]="streetRef.invalid && streetRef.touched"
      />
      <div class="error-message" *ngIf="streetRef.invalid && streetRef.touched">
        Bitte Stra√üe eingeben.
      </div>
    </div>

    <!-- Hausnummer -->
    <div class="form-group">
      <label for="houseNumber">Hausnummer *</label>
      <input
        type="text"
        id="houseNumber"
        [(ngModel)]="checkoutForm.houseNumber"
        name="houseNumber"
        required
        #houseNumberRef="ngModel"
        [class.invalid]="houseNumberRef.invalid && houseNumberRef.touched"
      />
      <div class="error-message" *ngIf="houseNumberRef.invalid && houseNumberRef.touched">
        Bitte Hausnummer eingeben.
      </div>
    </div>

    <!-- Telefonnummer -->
    <div class="form-group">
      <label for="phone-delivery">Telefonnummer *</label>
      <input
        type="tel"
        id="phone-delivery"
        [(ngModel)]="checkoutForm.phone"
        name="phoneDelivery"
        required
        #phoneDeliveryRef="ngModel"
        [class.invalid]="phoneDeliveryRef.invalid && phoneDeliveryRef.touched"
      />
      <div class="error-message" *ngIf="phoneDeliveryRef.invalid && phoneDeliveryRef.touched">
        Bitte Telefonnummer eingeben.
      </div>
    </div>

    <!-- Uhrzeit optional -->
    <div class="form-group">
      <label for="deliveryTime">Bestimmte Uhrzeit (optional)</label>
      <input type="time" id="deliveryTime" [(ngModel)]="checkoutForm.deliveryTime" />
    </div>
  </div>

  <!-- ü™ô Bezahlbutton -->
  <div class="checkout-footer">
    <button type="button" class="btn btn-primary btn-lg w-100" (click)="finalizeOrder()">
      Zur Bezahlung
    </button>
  </div>
</div>
